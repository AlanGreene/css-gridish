@import "variables";
@import "values";

/// Traverse maps and retrieve deeply nested values.
/// @author Hugo Giraudel
/// @param {map} A sass map.
/// @param {arglist} Any number of keys.
/// @return {*} Nested values or nested map.
@function map-deep-get($map, $keys...) {
  @each $key in $keys {
    $map: map-get($map, $key);
  }
  @return $map;
}

/// Function returns the rem value of a given breakpoint.
/// @param {string} An existing breakpoint name (sm, md, lg, amd so on).
/// @return {length} The breakpoint value in rems.
@function getBreakpointValue($breakpointName) {
  $breakpointValue: map-deep-get($allBreakpoints, $breakpointName, 'breakpoint');
  @return $breakpointValue * 1rem;
}

/// Returns a calc() expression that represents a fluid width at a given breakpoint.
/// @param {string} A valid breakpoint (sm, md, lg, xlg, or max)
/// @param {number} The number of columns to span across.
/// @return {length} A calc() expression representing fluid width.
@function getFluidSize($breakpointName, $columnSpan) {
  $breakpoint: map-get($allBreakpoints, $breakpointName);
  $columnTotal: map-get($breakpoint, columns);
  $margin: map-get($breakpoint, margin);

  @if (map-get($breakpoint, columns) != null) {
    @error 'The provided breakpoint #{$breakpointName} needs to have a total number of columns set in $grid-values.';
  }

  // For IE, we can't have a 0 in the $fluidWidth calc()
  @if ($margin == 0) {
    @return calc((100vw) * #{$columnSpan} / #{$columnTotal});
  }

  @return calc((100vw - (#{$margin} * 2)) * #{$columnSpan} / #{$columnTotal});
}

/// Gets a calculated rem value for a fixed nondimensional unit size.
/// @param {number} Fixed nondimensional units.
/// @return {length} A calculated rem value.
@function getFixedSize($fixedUnit) {

  $remValue: 0; // default

  @if $fixedUnit != null and $fixedUnit > 0 {
    $remValue: $fixedUnit * map-get($grid-values, 'rowHeight') * 1rem;
  }
  @else {
    @error 'The provided value #{$fixedUnit} to getFixedSize() is not a number.'
  }

  @return $remValue;
}

/// Utility for declaring mobile-first media queries.
/// @param {String} $breakpoint-name The name of the breakpoint to set its width value to media query.
@mixin media-query($breakpointNme) {
  @media screen and (min-width: #{getBreakpointValue($breakpointName)}) {
    @content;
  }
}